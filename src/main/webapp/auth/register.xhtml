<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
        <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
        <title>Cadastro</title>
        <!-- BEGIN PAGE STYLES -->
        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"></link>
        <link href="../resources/lib/css/slick.min.css" rel="stylesheet"></link>
        <link type="text/css" rel="StyleSheet" media="all" href="/resources/common/css/reset.css"></link>
        <link type="text/css" rel="StyleSheet" media="all" href="/resources/common/css/global.css"></link>
        <link type="text/css" rel="StyleSheet" media="all" href="/resources/common/css/login.css"></link>
        <!-- END PAGE STYLES -->
        <link rel="shortcut icon" href="/resources/common/images/guigoh.png"></link>
    </h:head>
    <h:body>
        <f:event type="preRenderComponent" listener="#{registerBean.init()}"/>
        <header>
            <div class="container">
                <div class="header-logo">
                    <img class="logo-guigoh" src="../resources/common/images/logo-guigoh.png"></img>
                    <img class="logo-ipti" src="../resources/common/images/logo-ipti.png"></img>
                </div>
                <div class="title">
                    <h1>Cadastro</h1>
                </div>
            </div>
        </header>
        <section>
            <h:form prependId="false" id="form-panel">
                <h:panelGroup layout="block" class="container">
                    <div class="content">
                        <div class="main-register">
                            <h:messages styleClass="msg" errorClass="error" infoClass="info"/>
                            <div class="profile">
                                <p style="font-size: 22px">Olá calouro!</p>
                                <p>Seu cadastro no Guigoh é simples e fácil. Por favor preencha os campos abaixo.</p>
                                <div class="col-2">
                                    <h:inputText pt:placeholder="Nome" value="#{registerBean.socialProfile.name}"></h:inputText>
                                    <h:inputText pt:placeholder="E-mail" value="#{registerBean.user.username}"></h:inputText>
                                    <h:inputSecret pt:placeholder="Senha" value="#{registerBean.user.password}"></h:inputSecret>
                                    <div class="select">
                                        <h:selectOneMenu value="#{registerBean.user.secretQuestionId}" converter="entityConverter">
                                            <f:selectItem itemLabel="Pergunta secreta" itemValue=""/>
                                            <f:selectItems value="#{registerBean.questionsList}" var="questions" itemValue="#{questions}" itemLabel="#{questions.name}" />
                                        </h:selectOneMenu>
                                    </div>
                                    <hr></hr>
                                </div>
                                <div class="col-2">
                                    <h:inputText pt:placeholder="sobrenome" value="#{registerBean.lastName}"></h:inputText>
                                    <h:inputText pt:placeholder="confirmação de e-mail" value="#{registerBean.usernameConfirm}"></h:inputText>
                                    <h:inputSecret pt:placeholder="confirmação de senha" value="#{registerBean.passwordConfirm}"></h:inputSecret>
                                    <h:inputText pt:placeholder="resposta da pergunta secreta" value="#{registerBean.user.secretAnswer}"></h:inputText>
                                </div>
                                <div class="clear"></div>
                            </div>
                            <div class="school">
                                <p>Alguns dados sobre sua instituição de ensino.</p>
                                <div class="col-2">
                                    <div class="select">
                                        <h:selectOneMenu value="#{registerBean.socialProfile.subnetworkId}" converter="entityConverter">
                                            <f:selectItem itemLabel="Selecione sua instituição de ensino" itemValue=""/>
                                            <f:selectItems value="#{registerBean.subnetworkList}" var="subnetwork" itemValue="#{subnetwork}" itemLabel="#{subnetwork.description}" />
                                        </h:selectOneMenu>
                                    </div>
                                    <div class="select">
                                        <h:selectOneMenu value="#{registerBean.socialProfile.roleId}" converter="entityConverter">
                                            <f:selectItem itemLabel="Selecione o seu cargo" itemValue=""/>
                                            <f:selectItems value="#{registerBean.roleList}" var="role" itemValue="#{role}" itemLabel="#{role.name}" />
                                        </h:selectOneMenu>
                                    </div>
                                    <div class="select">
                                        <h:selectOneMenu value="#{registerBean.socialProfile.languageId}" converter="entityConverter">
                                            <f:selectItem itemLabel="Selecione o idioma" itemValue=""/>
                                            <f:selectItems value="#{registerBean.languageList}" var="language" itemValue="#{language}" itemLabel="#{language.description}" />
                                        </h:selectOneMenu>
                                    </div>
                                </div>
                                <div class="col-2">
                                    <div class="select">
                                        <h:selectOneMenu value="#{registerBean.socialProfile.countryId}" converter="entityConverter" >
                                            <f:ajax event="valueChange" execute="@this" render="state city" listener="#{registerBean.loadState}"/>
                                            <f:selectItem itemLabel="Selecione o país" itemValue=""/>
                                            <f:selectItems value="#{registerBean.countryList}" var="country" itemValue="#{country}" itemLabel="#{country.name}" />
                                        </h:selectOneMenu>
                                    </div>
                                    <h:panelGroup layout="block" class="select" id="state">
                                        <h:selectOneMenu value="#{registerBean.socialProfile.stateId}" converter="entityConverter">
                                            <f:selectItem itemLabel="Selecione o estado" itemValue=""/>
                                            <f:selectItems value="#{registerBean.stateList}" var="state" itemValue="#{state}" itemLabel="#{state.name}" />
                                            <f:ajax render="city" listener="#{registerBean.loadCity()}"/>
                                        </h:selectOneMenu>
                                    </h:panelGroup>
                                    <h:panelGroup layout="block" class="select" id="city">
                                        <h:selectOneMenu value="#{registerBean.socialProfile.cityId}" converter="entityConverter">
                                            <f:selectItem itemLabel="Selecione a cidade" itemValue=""/>
                                            <f:selectItems value="#{registerBean.cityList}" var="city" itemValue="#{city}" itemLabel="#{city.name}" />
                                        </h:selectOneMenu>
                                    </h:panelGroup>
                                </div>
                                <div class="buttons col-1">
                                    <a class="back pull-left" href="../auth/login.xhtml"><i class="fa fa-chevron-circle-left pull-left fa-2x fa-fw black"></i></a>
                                    <h:commandLink action="#{registerBean.register()}">
                                        <button class="submit pointer">Cadastre-se</button>
                                    </h:commandLink>
                                </div>
                                <div class="clear"></div>
                            </div>
                        </div>
                        <div class="clear"></div>
                    </div>
                </h:panelGroup>
            </h:form>
        </section>
        <footer>
            <div class="container">
                <h3>apoio</h3>
                <div class="carousel">
                    <div><img src="../resources/common/images/logos/1.png"/></div>
                    <div><img src="../resources/common/images/logos/2.png"/></div>
                    <div><img src="../resources/common/images/logos/3.png"/></div>
                    <div><img src="../resources/common/images/logos/4.png"/></div>
                    <div><img src="../resources/common/images/logos/5.png"/></div>
                    <div><img src="../resources/common/images/logos/6.png"/></div>
                    <div><img src="../resources/common/images/logos/7.png"/></div>
                    <div><img src="../resources/common/images/logos/8.png"/></div>
                    <div><img src="../resources/common/images/logos/9.png"/></div>
                </div>
            </div>
        </footer>

        <!-- BEGIN PAGE SCRIPTS -->
        <script type="text/javascript" src="../resources/lib/js/jquery-1.11.3.min.js"/>
        <script type="text/javascript" src="../resources/lib/js/slick.min.js"/>
        <script>
            $('.carousel').slick({
                slidesToShow: 5,
                slidesToScroll: 1,
                autoplay: true,
                autoplaySpeed: 2000,
                arrows: false,
                pauseOnHover: false
            });

            $('select').each(changeSelectColors);
            $('select').on("change", changeSelectColors);
            $('select').on("change", checkLength);
            function changeSelectColors() {
                if ($(this).children('option:first-child').is(':selected')) {
                    $(this).css("color", "rgba(0, 0, 0, 0.5)");
                } else {
                    $(this).css("color", "black");
                }
                $(this).children("option").not(":eq(0)").css("color", "black");
                $(this).children("option:first-child").css("color", "rgba(0, 0, 0, 0.5)");
            }
            function checkLength() {
                if ($(this).children("option:selected").text().trim().length > 45) {
                    var string = $(this).children("option:selected").text();
                    $(this).children("option:selected").text(string.substring(0, 45) + "...");
                }
            }

            $(document).on("keypress", "input", function(event) {
                if (event.which == 13) {
                    event.preventDefault();
                    $(".forward").click();
                }
            });

            function setCursors(ajax) {
                if (ajax === "begin") {
                    $('body').css('cursor', 'wait');
                    $('.row-details').css('cursor', 'wait');
                    $('a').css('cursor', 'wait');
                } else {
                    $('body').css('cursor', 'auto');
                    $('.row-details').css('cursor', 'pointer');
                    $('a').css('cursor', 'pointer');
                }
            }

            jsf.ajax.addOnEvent(function(data) {
                switch (data.status) {
                    case "begin":
                        setCursors(data.status);
                        break;
                    case "success":
                        setCursors(data.status);
                        $('select').each(changeSelectColors);
                        $('select').on("change", changeSelectColors);
                        break;
                }
            });

        </script>
        <!-- END PAGE SCRIPTS -->
    </h:body>
</html>
