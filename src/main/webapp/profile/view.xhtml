<ui:composition template="/template/default/template.xhtml" 
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:pt="http://xmlns.jcp.org/jsf/passthrough">
    <ui:define name="title">#{localeBean.getString('Perfil')}</ui:define>
    <!-- BEGIN PAGE STYLES -->
    <ui:define name="styles">
        <link type="text/css" rel="StyleSheet" media="all" href="/resources/lib/css/jquery.Jcrop.min.css"></link>
        <link type="text/css" rel="StyleSheet" media="all" href="/resources/common/css/profile-view.css"></link>
    </ui:define>
    <!-- END PAGE STYLES -->
    <ui:define name="content">
        <f:metadata>
            <f:event type="preRenderComponent" listener="#{profileViewBean.init()}"/>
        </f:metadata>
        <h:form prependId="false" enctype="multipart/form-data">
            <h:inputHidden id="social-profile-id" value="#{profileViewBean.socialProfile.socialProfileId}"/>
            <h:inputHidden id="social-profile-name" value="#{profileViewBean.socialProfile.name}"/>
            <div class="profile-cover-image">
                <img src="#{profileViewBean.socialProfile.coverPhoto}"/>
                <h:panelGroup rendered="#{profileViewBean.himself}" class="edit-photo cover-photo fa fa-pencil"/>
            </div>
            <div class="profile-resume">
                <div class="profile-image">
                    <img src="#{profileViewBean.socialProfile.photo}"/>
                    <h:panelGroup rendered="#{profileViewBean.himself}" class="edit-photo photo fa fa-pencil"/>
                </div>
                <p class="image-error"></p>
                <div class="profile-name">
                    <h1>#{profileViewBean.socialProfile.name}</h1>
                    <ui:fragment rendered="#{profileViewBean.socialProfile.occupationsId.name != null}">
                        <p>#{profileViewBean.socialProfile.occupationsId.name}</p>
                    </ui:fragment>
                    <ui:fragment rendered="#{profileViewBean.socialProfile.occupationsId.name == null and profileViewBean.himself}">
                        <a class="add-new"><i class="fa fa-plus-square"></i> <span>Adicionar ocupação</span></a>
                    </ui:fragment>
                </div>
                <div class="profile-status">
                    <ui:fragment rendered="#{profileViewBean.socialProfile.description != null}">
                        <blockquote>#{profileViewBean.socialProfile.description}</blockquote>
                    </ui:fragment>
                    <ui:fragment rendered="#{profileViewBean.socialProfile.description == null and profileViewBean.himself}">
                        <a class="add-new"><i class="fa fa-plus-square"></i> <span>Adicionar uma descrição</span></a>
                    </ui:fragment>
                </div>
                <div class="clear"/>
            </div>
            <ui:fragment rendered="#{!profileViewBean.himself}">
                <h:panelGroup layout="block" id="profile-options" class="profile-options">
                    <ui:fragment rendered="#{profileViewBean.isFriend().status eq 'AC'}">
                        <h:commandLink>
                            <img class="friend-status" src="../resources/common/images/remove-friend-gray.png"/>
                            <f:ajax listener="#{profileViewBean.removeFriend}" render="profile-options"/>
                        </h:commandLink>
                    </ui:fragment>
                    <ui:fragment rendered="#{profileViewBean.isFriend().status eq 'PE'}">
                        <h:commandLink>
                            <img class="friend-status" src="../resources/common/images/pending-friend-gray.png"/>
                            <f:ajax listener="#{profileViewBean.removeFriend}" render="profile-options"/>
                        </h:commandLink>
                    </ui:fragment>
                    <ui:fragment rendered="#{profileViewBean.isFriend().status eq null}">
                        <h:commandLink>
                            <img class="friend-status" src="../resources/common/images/add-friend-gray.png"/>
                            <f:ajax listener="#{profileViewBean.addFriend}" render="profile-options"/>
                        </h:commandLink>
                    </ui:fragment>
                    <img class="open-chat" src="../resources/common/images/chat.png"/>
                </h:panelGroup>
            </ui:fragment>
            <div class="profile-tabs">
                <ul>
                    <li id="profile-tab-about" class="active"><span class="tab tab-about">Sobre</span></li>
                    <li id="profile-tab-objects"><span class="tab tab-objects">Objetos Educacionais</span></li>
                    <li id="profile-tab-resume"><span class="tab tab-resume">Currículo</span></li>
                </ul>
            </div>
            <div class="clear"></div>
            <div id="profile-container-about" class="profile-container">
                <div class="profile-column-left">
                    <div class="profile-about-list">
                        <div class="profile-about-title">
                            <h3>
                                <img id="profile-icon-heart" src="../resources/common/images/heart.png"/>
                                Matérias<br/> de Interesse
                            </h3>
                        </div>
                        <div class="profile-about-description">
                            <ui:fragment rendered="#{profileViewBean.socialProfile.mattersOfInterest != null}">
                                <p>#{profileViewBean.socialProfile.mattersOfInterest}</p>
                            </ui:fragment>
                            <ui:fragment rendered="#{profileViewBean.socialProfile.mattersOfInterest == null}">
                                <a class="add-new"><i class="fa fa-plus-square"></i> <span>Adicionar matérias de interesse</span></a>
                            </ui:fragment>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <hr />
                    <div class="profile-about-list">
                        <div class="profile-about-title">
                            <h3>
                                <img id="profile-icon-music" src="../resources/common/images/music.png"/>
                                Músicas
                            </h3>
                        </div>
                        <div class="profile-about-description">
                            <p>#{profileViewBean.socialProfile.musics}</p>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <hr />
                    <div class="profile-about-list">
                        <div class="profile-about-title">
                            <h3>
                                <img id="profile-icon-book" src="../resources/common/images/book.png"/>
                                Livros
                            </h3>
                        </div>
                        <div class="profile-about-description">
                            <p>#{profileViewBean.socialProfile.books}</p>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <hr />
                    <div class="profile-about-list">
                        <div class="profile-about-title">
                            <h3>
                                <img id="profile-icon-movie" src="../resources/common/images/movie.png"/>
                                Filmes
                            </h3>
                        </div>
                        <div class="profile-about-description">
                            <p>#{profileViewBean.socialProfile.movies}</p>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <hr />
                    <div class="profile-about-list">
                        <div class="profile-about-title">
                            <h3>
                                <img id="profile-icon-sport" src="../resources/common/images/sport.png"/>
                                Esportes
                            </h3>
                        </div>
                        <div class="profile-about-description">
                            <p>#{profileViewBean.socialProfile.sports}</p>
                        </div>
                        <div class="clear"></div>
                    </div>
                    <hr />
                    <div class="profile-about-list">
                        <div class="profile-about-title">
                            <h3>
                                <img id="profile-icon-hobbie" src="../resources/common/images/hobbie.png"/>
                                Hobbies
                            </h3>
                        </div>
                        <div class="profile-about-description">
                            <p>#{profileViewBean.socialProfile.hobbies}</p>
                        </div>
                        <div class="clear"></div>
                    </div>
                </div>
                <div class="profile-column-right">
                    <p id="profile-icon-mail"><img src="../resources/common/images/mail.png"/><span title="#{profileViewBean.socialProfile.users.username}">#{profileViewBean.socialProfile.users.username}</span></p>
                    <p id="profile-icon-birthday"><img src="../resources/common/images/birthday.png"/>#{profileViewBean.socialProfile.birthDate}</p>
                </div>
                <div class="clear"></div>
            </div>
            <div id="profile-container-objects" class="profile-container">
                <div class="profile-column-left">
                    <ui:repeat value="#{profileViewBean.educationalObjectList}" var="educationalObject">
                        <div class="item-box-container">
                            <a href="/educational-object/view.xhtml?id=#{educationalObject.id}"><img class="item-box-img" src="#{educationalObject.image}"/></a>
                            <p class="item-box-title">Publicador</p>
                            <p class="item-box-aux">em</p>
                            <a class="item-box-title-bold" href="/educational-object/view.xhtml?id=#{educationalObject.id}"><p>#{educationalObject.name}</p></a>
                            <div class="item-box-date">
                                <img src="../resources/common/images/clock.png"/>
                                <h:outputText value="#{educationalObject.date}">
                                    <f:convertDateTime pattern="dd/MM/yyyy" timeZone="GMT-3"></f:convertDateTime>
                                </h:outputText>
                            </div>
                        </div>
                    </ui:repeat>
                </div>
                <div class="profile-column-right">
                    <p class="profile-object-number"><span>#{profileViewBean.educationalObjectList.size()}</span><br />Objetos <br />Educacionais <br />publicados</p>
                </div>
                <div class="clear"></div>
            </div>
            <div id="profile-container-resume" class="profile-container">
                <div class="profile-column-left">
                    <div class="profile-resume-left">
                        <p class="profile-resume-title">Currículo</p>
                        <p class="profile-resume-name">#{profileViewBean.socialProfile.name}</p>
                        <p class="profile-resume-ocupation">#{profileViewBean.socialProfile.occupationsId.name}</p>
                    </div>
                    <div class="profile-resume-right">
                        <p class="bold">#{profileViewBean.socialProfile.users.username}</p>
                        <p class="bold">#{profileViewBean.socialProfile.phone}</p><br/>
                        <p>
                            #{profileViewBean.socialProfile.address}<ui:fragment rendered="#{profileViewBean.socialProfile.address != null and profileViewBean.socialProfile.number != null}">, </ui:fragment>
                            #{profileViewBean.socialProfile.number}
                        </p>
                        <p> 
                            <ui:fragment rendered="#{profileViewBean.socialProfile.neighborhood != null}">Bairro #{profileViewBean.socialProfile.neighborhood}</ui:fragment>
                            <ui:fragment rendered="#{profileViewBean.socialProfile.neighborhood != null and profileViewBean.socialProfile.zipcode != null}">. </ui:fragment>
                                #{profileViewBean.socialProfile.zipcode}
                        </p>
                        <p>#{profileViewBean.socialProfile.cityId.name} - #{profileViewBean.socialProfile.stateId.name} - #{profileViewBean.socialProfile.countryId.name}</p>
                    </div>
                    <div class="clear"></div>
                    <div class="profile-resume-history">
                        <div class="profile-history-container">
                            <p class="profile-history-title">Educação</p>
                        </div>
                        <ui:repeat value="#{profileViewBean.socialProfile.educationsCollection}" var="education">
                            <div class="profile-history-list">
                                <div class="profile-history-date">
                                    <h3>
                                        <h:outputText value="#{education.dataBegin}">
                                            <f:convertDateTime pattern="MM/yyyy" timeZone="GMT-3"></f:convertDateTime>
                                        </h:outputText> 
                                        - 
                                        <h:outputText value="#{education.dataEnd}">
                                            <f:convertDateTime pattern="MM/yyyy" timeZone="GMT-3"></f:convertDateTime>
                                        </h:outputText>
                                    </h3>
                                </div>
                                <div class="profile-history-description">
                                    <p>#{education.nameId.scholarityId.description}</p>
                                    <p>#{education.nameId.name}</p>
                                    <p class="italic">#{education.locationId.name}</p>
                                </div>
                                <div class="clear"></div>
                            </div>
                        </ui:repeat>
                        <div class="profile-history-container">
                            <p class="profile-history-title">Experiência</p>
                        </div>
                        <ui:repeat value="#{profileViewBean.socialProfile.experiencesCollection}" var="experience">
                            <div class="profile-history-list">
                                <div class="profile-history-date">
                                    <h3>
                                        <h:outputText value="#{experience.dataBegin}">
                                            <f:convertDateTime pattern="MM/yyyy" timeZone="GMT-3"></f:convertDateTime>
                                        </h:outputText> 
                                        - 
                                        <h:outputText value="#{experience.dataEnd}">
                                            <f:convertDateTime pattern="MM/yyyy" timeZone="GMT-3"></f:convertDateTime>
                                        </h:outputText>
                                    </h3>
                                </div>
                                <div class="profile-history-description">
                                    <p>#{experience.nameId.name}</p>
                                    <p class="italic">#{experience.locationId.name}</p>
                                </div>
                                <div class="clear"></div>
                            </div>
                        </ui:repeat>
                    </div>
                </div>
                <div class="profile-column-right">
                    <h:commandLink class="btn-gray" action="#{profileViewBean.downloadPDF()}">
                        Gerar PDF
                    </h:commandLink>
                </div>
                <div class="clear"></div>
            </div>
            <a id="open-image-cropping-modal" href="#image-cropping-modal"></a>
            <div id="image-cropping-modal" class="image-cropping-modal">
                <div>
                    <h1 class="modal-title">Cortar foto</h1>
                    <hr/>
                    <a href="#close" title="Close" id="close-image-cropping-modal" class="close-image-cropping-modal">X</a>
                    <div class="photo-container">
                        <img class="original-uploaded-image"/>
                    </div>
                    <hr/>
                    <div class="modal-buttons">
                        <span class="image-cropping-button cut-photo">
                            Cortar e salvar
                        </span>
                        <a href="#close" title="Close" class="image-cropping-button cancel">Cancelar</a>
                        <div class="clear"></div>
                    </div>
                </div>
            </div>
            <h:commandLink styleClass="upload-photo" action="#{profileViewBean.uploadPhoto('photo')}"/>
            <h:commandLink styleClass="upload-cover-photo" action="#{profileViewBean.uploadPhoto('cover')}"/>
            <h:inputFile id="browse-photo" pt:accept="image/x-png, image/jpeg" styleClass="hidden" value="#{profileViewBean.uploadedPhoto}"/>
            <h:inputHidden id="original-uploaded-image-tracker-x" value="#{profileViewBean.cropCoordinates[0]}"/>
            <h:inputHidden id="original-uploaded-image-tracker-y" value="#{profileViewBean.cropCoordinates[1]}"/>
            <h:inputHidden id="original-uploaded-image-tracker-w" value="#{profileViewBean.cropCoordinates[2]}"/>
            <h:inputHidden id="original-uploaded-image-tracker-h" value="#{profileViewBean.cropCoordinates[3]}"/>
        </h:form>
    </ui:define>
    <!-- BEGIN PAGE SCRIPTS -->
    <ui:define name="scripts">
        <script type="text/javascript" src="/resources/lib/js/jquery.Jcrop.min.js"></script>
        <script type="text/javascript" src="/resources/common/js/profile-view.js"></script>
    </ui:define>
    <!-- END PAGE SCRIPTS -->
</ui:composition>