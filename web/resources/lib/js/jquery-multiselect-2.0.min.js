!function(e){function t(t){var i,s=e.uix.multiselect.i18n[t.locale]?t.locale:"",l=e.uix.multiselect.i18n[s],a=t.plural||0,o=t.data||{};return i=2==a&&l[t.key+"_plural_two"]?l[t.key+"_plural_two"]:2!=a&&3!=a||!l[t.key+"_plural_few"]?a>1&&l[t.key+"_plural"]?l[t.key+"_plural"]:0==a&&l[t.key+"_nil"]?l[t.key+"_nil"]:l[t.key]||"":l[t.key+"_plural_few"],i.replace(/\{([^\}]+)\}/g,function(e,t){return o[t]})}var i=0,s="",l="group-",a="multiselectChange",o="multiselectSearch";e.widget("uix.multiselect",{options:{availableListPosition:"right",collapsableGroups:!0,defaultGroupName:"",filterSelected:!1,locale:"auto",moveEffect:null,moveEffectOptions:{},moveEffectSpeed:null,optionRenderer:!1,searchField:"toggle",searchHeader:"available",selectionMode:"click,d&d",showDefaultGroupHeader:!1,showEmptyGroups:!1,splitRatio:.55,sortable:!1,sortMethod:null},_create:function(){var t,s,l,a,o,n,r=this;this.scope="multiselect"+i++,this.optionGroupIndex=1,this._setLocale(this.options.locale),this.element.addClass("uix-multiselect-original"),this._elementWrapper=e("<div></div>").addClass("uix-multiselect ui-widget").css({width:this.element.outerWidth(),height:this.element.outerHeight()}).append(e("<div></div>").addClass("multiselect-selected-list").append(e("<div></div>").addClass("ui-widget-header").append(n=e("<button></button>").addClass("uix-control-right").attr("data-localekey","deselectAll").attr("title",this._t("deselectAll")).button({icons:{primary:"ui-icon-arrowthickstop-1-e"},text:!1}).click(function(e){return e.preventDefault(),e.stopPropagation(),r.optionCache.setSelectedAll(!1),!1})).append(t=e("<div></div>").addClass("header-text"))).append(s=e("<div></div>").addClass("uix-list-container ui-widget-content")))["right,top".indexOf(this.options.availableListPosition)>=0?"prepend":"append"](e("<div></div>").addClass("multiselect-available-list").append(e("<div></div>").addClass("ui-widget-header").append(o=e("<button></button>").addClass("uix-control-right").attr("data-localekey","selectAll").attr("title",this._t("selectAll")).attr("disabled",!0).button({icons:{primary:"ui-icon-arrowthickstop-1-w"},text:!1}).click(function(e){return e.preventDefault(),e.stopPropagation(),r.optionCache.setSelectedAll(!0),!1})).append(l=e("<div></div>").addClass("header-text"))).append(a=e("<div></div>").addClass("uix-list-container ui-widget-content"))).insertAfter(this.element),this._buttons={selectAll:o,deselectAll:n},this._headers={selected:t,available:l},this._lists={selected:s.attr("id",this.scope+"_selListContent"),available:a.attr("id",this.scope+"_avListContent")},this.optionCache=new _(this),this._searchDelayed=new h(this,{delay:500}),this._initSearchable(),this._applyListDroppable(),this.refresh()},refresh:function(t){this._resize(),c(function(){this.optionCache.cleanup();for(var i,s=this.element[0].childNodes,a=0,o=s.length;o>a;a++)if(i=s[a],1==i.nodeType)if("OPTGROUP"==i.tagName.toUpperCase()){var n=e(i).data("option-group")||l+this.optionGroupIndex++,r=i.childNodes;this.optionCache.prepareGroup(e(i),n);for(var d=0,p=r.length;p>d;d++)i=r[d],1==i.nodeType&&this.optionCache.prepareOption(e(i),n)}else this.optionCache.prepareOption(e(i));this.optionCache.reIndex(),this._searchField&&this._searchField.is(":visible")&&this._search(null,!0),t&&t()},10,this)},search:function(e){"object"!=typeof e&&(e={showInput:!0,text:e}),0==e.toggleInput||this._searchField.is(":visible")||this._buttons.search.trigger("click"),this._search(e.text,!!e.silent)},locale:function(e){return void 0==e?this.options.locale:(this._setLocale(e),this._updateControls(),this._updateHeaders(),void 0)},destroy:function(){this._super(),this.optionCache.reset(!0),this._lists.selected.empty().remove(),this._lists.available.empty().remove(),this._elementWrapper.empty().remove(),delete this.optionCache,delete this._searchDelayed,delete this._lists,delete this._elementWrapper,this.element.removeClass("uix-multiselect-original")},_initSearchable:function(){var t="toggle"===this.options.searchField,i=this.options.searchHeader;if(t){var s=this;this._buttons.search=e("<button></button").addClass("uix-control-right").attr("data-localekey","search").attr("title",this._t("search")).button({icons:{primary:"ui-icon-search"},text:!1}).click(function(t){if(t.preventDefault(),t.stopPropagation(),s._searchField.is(":visible")){var l=e(this);s._headers[i].css("visibility","visible").fadeTo("fast",1),s._searchField.hide("slide",{direction:"right"},200,function(){l.removeClass("ui-corner-right ui-state-active").addClass("ui-corner-all")}),s._searchDelayed.cancelLastRequest(),s.optionCache.filter("")}else s._headers[i].fadeTo("fast",.1,function(){e(this).css("visibility","hidden")}),e(this).removeClass("ui-corner-all").addClass("ui-corner-right ui-state-active"),s._searchField.show("slide",{direction:"right"},200,function(){e(this).focus()}),s._search();return!1}).insertBefore(this._headers[i])}this.options.searchField&&(t||this._headers[i].hide(),this._searchField=e('<input type="text" />').addClass("uix-search ui-widget-content ui-corner-"+(t?"left":"all"))[t?"hide":"show"]().insertBefore(this._headers[i]).focus(function(){e(this).select()}).keyup(e.proxy(this._searchDelayed.request,this._searchDelayed)))},_applyListDroppable:function(){if(-1!=this.options.selectionMode.indexOf("d&d")){var t=this.optionCache,i=this.scope,s=function(e){return t._elements[e.data("element-index")]},l=function(e,l){e.droppable({accept:function(e){var t=s(e);return t&&t.selected!=l},activeClass:"ui-state-highlight",scope:i,drop:function(e,i){i.draggable.removeClass("ui-state-disabled"),i.helper.remove(),t.setSelected(s(i.draggable),l)}})};if(l(this._lists.selected,!0),l(this._lists.available,!1),this.options.sortable){var a=this;this._lists.selected.sortable({appendTo:"parent",axis:"y",containment:e(".multiselect-selected-list",this._elementWrapper),items:".multiselect-element-wrapper",handle:".group-element",revert:!0,stop:e.proxy(function(){var t;e(".multiselect-element-wrapper",a._lists.selected).each(function(){var i=a.optionCache._groups.get(e(this).data("option-group"));t?i.groupElement.insertAfter(t.groupElement):a.element.append(i.groupElement),t=i})},this)})}}},_search:function(e,t){this._searchField.is(":visible")?e?this._searchField.val(e):e=this._searchField.val():e=""+e,this.optionCache.filter(e,t)},_setLocale:function(t){"auto"==t&&(t=navigator.userLanguage||navigator.language||navigator.browserLanguage||navigator.systemLanguage||""),e.uix.multiselect.i18n[t]||(t=""),this.options.locale=t},_t:function(e,i,s){return t({locale:this.options.locale,key:e,plural:i,data:s})},_updateControls:function(){var t=this;e(".uix-control-left,.uix-control-right",this._elementWrapper).each(function(){e(this).attr("title",t._t(e(this).attr("data-localekey")))})},_updateHeaders:function(){var e,t=this.optionCache.getSelectionInfo();this._headers.selected.text(e=this._t("itemsSelected",t.selected.total,{count:t.selected.total})).parent().attr("title",this.options.filterSelected?this._t("itemsSelected",t.selected.count,{count:t.selected.count})+", "+this._t("itemsFiltered",t.selected.filtered,{count:t.selected.filtered}):e),this._headers.available.text(this._t("itemsAvailable",t.available.total,{count:t.available.total})).parent().attr("title",this._t("itemsAvailable",t.available.count,{count:t.available.count})+", "+this._t("itemsFiltered",t.available.filtered,{count:t.available.filtered}))},_resize:function(){var e=this.options.availableListPosition.toLowerCase(),t="left,right".indexOf(e)>=0?"Width":"Height",i="left,right".indexOf(e)>=0?"Height":"Width",s=this.element["outer"+t]()*this.options.splitRatio,l=this.element["outer"+t]()-s,a="Width"===i?s:this.element.outerHeight(),o="Width"===i?l:this.element.outerHeight(),n="left,right".indexOf(e)>=0?"left":"top",r="left,top".indexOf(e)>=0,d="toggle"===this.options.searchField,c="ui-corner-tl ui-corner-tr ui-corner-bl ui-corner-br ui-corner-top",h="Width"===i?r?"":"ui-corner-top":r?"ui-corner-tr":"ui-corner-tl",u="Width"===i?r?"ui-corner-top":"":r?"ui-corner-tl":"ui-corner-tr";if(this._elementWrapper.find(".multiselect-available-list")[t.toLowerCase()](l).css(n,r?0:s)[i.toLowerCase()](this.element["outer"+i]()+1),this._elementWrapper.find(".multiselect-selected-list")[t.toLowerCase()](s).css(n,r?l:0)[i.toLowerCase()](this.element["outer"+i]()+1),this._buttons.selectAll.button("option","icons",{primary:p(e,"ui-icon-arrowthickstop-1-",!1)}),this._buttons.deselectAll.button("option","icons",{primary:p(e,"ui-icon-arrowthickstop-1-",!0)}),this._headers.available.parent().removeClass(c).addClass(u),this._headers.selected.parent().removeClass(c).addClass(h),!d){var _=Math.max(this._headers.selected.parent().height(),this._headers.available.parent().height());this._headers.available.parent().height(_),this._headers.selected.parent().height(_)}this._searchField&&this._searchField.width(this._headers.available.parent().width()-(d?48:24)),this._lists.available.height(o-this._headers.available.parent().outerHeight()-2),this._lists.selected.height(a-this._headers.selected.parent().outerHeight()-2)},_triggerUIEvent:function(t,i){return"string"==typeof t&&(t=e.Event(t)),this.element.trigger(t,i),!t.isDefaultPrevented()},_setOption:function(t){"function"==typeof this._superApply?this._superApply(arguments):e.Widget.prototype._setOption.apply(this,arguments)}});var n={standard:function(e,t){return e>t?1:t>e?-1:0},natural:function f(e,t){var i,s,l=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,a=/(^[ ]*|[ ]*$)/g,o=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,n=/^0x[0-9a-f]+$/i,r=/^0/,d=function(e){return f.insensitive&&(""+e).toLowerCase()||""+e},p=d(e).replace(a,"")||"",c=d(t).replace(a,"")||"",h=p.replace(l,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),u=c.replace(l,"\x00$1\x00").replace(/\0$/,"").replace(/^\0/,"").split("\x00"),_=parseInt(p.match(n))||1!=h.length&&p.match(o)&&Date.parse(p),m=parseInt(c.match(n))||_&&c.match(o)&&Date.parse(c)||null;if(m){if(m>_)return-1;if(_>m)return 1}for(var g=0,v=Math.max(h.length,u.length);v>g;g++){if(i=!(h[g]||"").match(r)&&parseFloat(h[g])||h[g]||0,s=!(u[g]||"").match(r)&&parseFloat(u[g])||u[g]||0,isNaN(i)!==isNaN(s))return isNaN(i)?1:-1;if(typeof i!=typeof s&&(i+="",s+=""),s>i)return-1;if(i>s)return 1}return 0}},r=["n","e","s","w"],d=["bottom","left","top","right"],p=function(t,i,s){return i+r[(e.inArray(t.toLowerCase(),d)+(s?2:0))%4]},c=function(e,t,i){var s=Array.prototype.slice.call(arguments,3);return setTimeout(function(){e.apply(i||window,s)},t)},h=function(e,t){this._widget=e,this._options=t,this._lastSearchValue=null};h.prototype={request:function(){this._widget._searchField.val()!=this._lastSearchValue&&(this.cancelLastRequest(),this._timeout=c(function(){this._timeout=null,this._lastSearchValue=this._widget._searchField.val(),this._widget._search()},this._options.delay,this))},cancelLastRequest:function(){this._timeout&&clearTimeout(this._timeout)}};var u=function(e){var t=[],i={},l=e;this.setComparator=function(e){return l=e,this},this.clear=function(){return t=[],i={},this},this.containsKey=function(e){return!!i[e]},this.get=function(e){return i[e]},this.put=function(e,a){return i[e]||(l?t.splice(function(){for(var e=0,o=t.length,n=-1,r=0;o>e;){n=parseInt((e+o)/2);var d=i[t[n]].groupElement,p=a.groupElement;if(r=l(d?d.attr("label"):s,p?p.attr("label"):s),0>r)e=n+1;else{if(!(r>0))return n;o=n}}return e}(),0,e):t.push(e)),i[e]=a,this},this.remove=function(e){return delete i[e],t.splice(t.indexOf(e),1)},this.each=function(e){var s=Array.prototype.slice.call(arguments,1);s.splice(0,0,null,null);for(var l=0,a=t.length;a>l;l++)s[0]=t[l],s[1]=i[t[l]],e.apply(s[1],s);return this}},_=function(t){this._widget=t,this._listContainers={selected:e("<div></div>").appendTo(this._widget._lists.selected),available:e("<div></div>").appendTo(this._widget._lists.available)},this._elements=[],this._groups=new u,this._moveEffect={fn:t.options.moveEffect,options:t.options.moveEffectOptions,speed:t.options.moveEffectSpeed},this._selectionMode=this._widget.options.selectionMode.indexOf("dblclick")>-1?"dblclick":this._widget.options.selectionMode.indexOf("click")>-1?"click":!1,this.reset()};_.Options={batchCount:200,batchDelay:50},_.prototype={_createGroupElement:function(t,i,l){var o,n,r=this,d=function(){return o||(o=r._groups.get(i)),o},c=function(){return t?t.attr("label"):r._widget.options.defaultGroupName},h=e("<span></span>").addClass("label").text(c()+" (0)").attr("title",c()+" (0)"),u=function(){var e=d()[l?"selected":"available"];e.listElement[!l&&(e.count||r._widget.options.showEmptyGroups)||e.count&&(o.optionGroup!=s||r._widget.options.showDefaultGroupHeader)?"show":"hide"]();var t=c()+" ("+e.count+")";h.text(t).attr("title",t)},_=e("<div></div>").addClass("ui-widget-header ui-priority-secondary group-element").append(e("<button></button>").addClass("uix-control-right").attr("data-localekey",(l?"de":"")+"selectAllGroup").attr("title",this._widget._t((l?"de":"")+"selectAllGroup")).button({icons:{primary:p(this._widget.options.availableListPosition,"ui-icon-arrowstop-1-",l)},text:!1}).click(function(e){e.preventDefault(),e.stopPropagation();d()[l?"selected":"available"];if(o.count>0){var t=[];r._bufferedMode(!0);for(var i,s=o.startIndex,n=o.startIndex+o.count;n>s;s++)i=r._elements[s],i.filtered||!i.selected==l||(r.setSelected(i,!l,!0),t.push(i.optionElement[0]));r._updateGroupElements(o),r._widget._updateHeaders(),r._bufferedMode(!1),r._widget._triggerUIEvent(a,{optionElements:t,selected:!l})}return!1})).append(h),f=t?t.attr("data-group-icon"):null;if(this._widget.options.collapsableGroups){var m=t?t.attr("data-collapse-icon"):null,g=m?"ui-icon "+m:"ui-icon ui-icon-triangle-1-s",v=e("<span></span>").addClass("ui-icon collapse-handle").attr("data-localekey","collapseGroup").attr("title",this._widget._t("collapseGroup")).addClass(g).mousedown(function(e){e.stopPropagation()}).click(function(e){return e.preventDefault(),e.stopPropagation(),n(t),!1}).prependTo(_.addClass("group-element-collapsable"));n=function(e){var t=d()[l?"selected":"available"],i=e?e.attr("data-collapse-icon"):null,s=e?e.attr("data-expand-icon"):null,a=i?"ui-icon "+i:"ui-icon ui-icon-triangle-1-s",o=s?"ui-icon "+s:"ui-icon ui-icon-triangle-1-e";t.collapsed=!t.collapsed,t.listContainer.slideToggle(),v.removeClass(t.collapsed?a:o).addClass(t.collapsed?o:a)}}else f&&e("<span></span>").addClass("collapse-handle "+f).css("cursor","default").prependTo(_.addClass("group-element-collapsable"));return e("<div></div>").data("fnUpdateCount",u).data("fnToggle",n||e.noop).append(_)},_createGroupContainerElement:function(t,i,s){var l,o=this,n=e("<div></div>");return this._widget.options.sortable&&s&&n.sortable({tolerance:"pointer",appendTo:this._widget._elementWrapper,connectWith:this._widget._lists.available.attr("id"),scope:this._widget.scope,helper:"clone",receive:function(e,t){var i=o._elements[l=t.item.data("element-index")];i.selected=!0,i.optionElement.prop("selected",!0),i.listElement.removeClass("ui-state-active")},stop:function(e,t){var i;l?(i=o._elements[l],l=void 0,t.item.replaceWith(i.listElement.addClass("ui-state-highlight option-selected")),o._widget._updateHeaders(),o._widget._triggerUIEvent(a,{optionElements:[i.optionElement[0]],selected:!0})):(i=o._elements[t.item.data("element-index")],i&&!i.selected&&(o._bufferedMode(!0),o._appendToList(i),o._bufferedMode(!1))),i&&o._reorderSelected(i.optionGroup)},revert:!0}),this._selectionMode&&e(n).on(this._selectionMode,"div.option-element",function(){var t=o._elements[e(this).data("element-index")];t.listElement.removeClass("ui-state-hover"),o.setSelected(t,!s)}),n},_createElement:function(t,i){var s=this._widget.options.optionRenderer?this._widget.options.optionRenderer(t,i):e("<div></div>").text(t.text()),l=t.attr("data-option-icon"),a=e("<div></div>").append(s).addClass("ui-state-default option-element").attr("unselectable","on").data("element-index",-1).hover(function(){t.prop("selected")&&e(this).removeClass("ui-state-highlight"),e(this).addClass("ui-state-hover")},function(){e(this).removeClass("ui-state-hover"),t.prop("selected")&&e(this).addClass("ui-state-highlight")});if(this._widget.options.selectionMode.indexOf("d&d")>-1){a.draggable({addClasses:!1,cancel:(this._widget.options.sortable?".option-selected, ":"")+".ui-state-disabled",appendTo:this._widget._elementWrapper,scope:this._widget.scope,start:function(t,i){e(this).addClass("ui-state-disabled ui-state-active"),i.helper.width(e(this).width()).height(e(this).height())},stop:function(){e(this).removeClass("ui-state-disabled ui-state-active")},helper:"clone",revert:"invalid",zIndex:99999,disabled:t.prop("disabled")}),t.prop("disabled")&&a.addClass("ui-state-disabled"),this._widget.options.sortable&&a.draggable("option","connectToSortable",this._groups.get(i).selected.listContainer)}else t.prop("disabled")&&a[(t.prop("disabled")?"add":"remove")+"Class"]("ui-state-disabled");return l&&a.addClass("grouped-option").prepend(e("<span></span>").addClass("ui-icon "+l)),a},_isOptionCollapsed:function(e){return this._groups.get(e.optionGroup)[e.selected?"selected":"available"].collapsed},_updateGroupElements:function(e){if(e){e.selected.count=0,e.available.count=0;for(var t=e.startIndex,i=e.startIndex+e.count;i>t;t++)e[this._elements[t].selected?"selected":"available"].count++;e.selected.listElement.data("fnUpdateCount")(),e.available.listElement.data("fnUpdateCount")()}else this._groups.each(function(e,t,i){i._updateGroupElements(t)},this)},_appendToList:function(e){var t=this._groups.get(e.optionGroup),i=t[e.selected?"selected":"available"];(e.optionGroup!=this._widget.options.defaultGroupName||this._widget.options.showDefaultGroupHeader)&&i.listElement.show(),i.collapsed?i.listElement.data("fnToggle")():i.listContainer.show();for(var s=e.index-1;s>=t.startIndex&&this._elements[s].selected!=e.selected;)s--;if(s<t.startIndex)i.listContainer.prepend(e.listElement);else{var l=this._elements[s].listElement;l.parent().hasClass("ui-effects-wrapper")&&(l=l.parent()),e.listElement.insertAfter(l)}e.listElement[(e.selected?"add":"remove")+"Class"]("ui-state-highlight option-selected"),!e.selected&&e.filtered||this._isOptionCollapsed(e)||!this._moveEffect||!this._moveEffect.fn?e.filtered&&e.listElement.hide():e.listElement.hide().show(this._moveEffect.fn,this._moveEffect.options,this._moveEffect.speed)},_reorderSelected:function(t){var i,s=this._elements,l=this._groups.get(t),a=l.groupElement?l.groupElement:this._widget.element;e(".option-element",l.selected.listContainer).each(function(){var t=s[e(this).data("element-index")].optionElement;i?t.insertAfter(i):a.prepend(t),i=t})},_bufferedMode:function(e){e?(this._oldMoveEffect=this._moveEffect,this._moveEffect=null,this._widget._lists.selected.data("scrollTop",this._widget._lists.selected.scrollTop()),this._widget._lists.available.data("scrollTop",this._widget._lists.available.scrollTop()),this._listContainers.selected.detach(),this._listContainers.available.detach()):(this._widget._lists.selected.append(this._listContainers.selected).scrollTop(this._widget._lists.selected.data("scrollTop")||0),this._widget._lists.available.append(this._listContainers.available).scrollTop(this._widget._lists.available.data("scrollTop")||0),this._moveEffect=this._oldMoveEffect,delete this._oldMoveEffect)},reset:function(t){this._groups.clear(),this._listContainers.selected.empty(),this._listContainers.available.empty(),t?(e.each(this._elements,function(e,t){t.optionElement.removeData("element-index")}),delete this._elements,delete this._groups,delete this._listContainers):(this._elements=[],this.prepareGroup(),this._groups.setComparator(this.getComparator()))},cleanup:function(){var t=this._widget.element[0],i=[];this._groups.each(function(s,l){l.groupElement&&!e.contains(t,l.groupElement[0])&&i.push(s)});for(var s,l=0;l<this._elements.length;l++)s=this._elements[l],(!e.contains(t,s.optionElement[0])||e.inArray(s.optionGroup,i)>-1)&&this._elements.splice(l--,1)[0].listElement.remove();for(var l=0,a=i.length;a>l;l++)this._groups.remove(i[l]);this.prepareGroup()},getComparator:function(){return this._widget.options.sortMethod?"function"==typeof this._widget.options.sortMethod?this._widget.options.sortMethod:n[this._widget.options.sortMethod]:null},prepareGroup:function(e,t){t=t||s,this._groups.containsKey(t)||this._groups.put(t,{startIndex:-1,count:0,selected:{collapsed:!1,count:0,listElement:this._createGroupElement(e,t,!0),listContainer:this._createGroupContainerElement(e,t,!0)},available:{collapsed:!1,count:0,listElement:this._createGroupElement(e,t,!1),listContainer:this._createGroupContainerElement(e,t,!1)},groupElement:e,optionGroup:t})},prepareOption:function(e,t){var i;void 0===e.data("element-index")?(t=t||s,this._elements.push(i={index:-1,selected:!1,filtered:!1,listElement:this._createElement(e,t),optionElement:e,optionGroup:t})):this._elements[e.data("element-index")].listElement[(e.prop("disabled")?"add":"remove")+"Class"]("ui-state-disabled")},reIndex:function(){var t=this.getComparator();if(t){var i=this._groups;this._elements.sort(function(e,l){var a=i.get(e.optionGroup).groupElement,o=i.get(l.optionGroup).groupElement,n=t(a?a.attr("label"):s,o?o.attr("label"):s);return 0!=n?n:t(e.optionElement.text(),l.optionElement.text())})}this._bufferedMode(!0),this._groups.each(function(t,i,l,a){if(!i.available.listContainer.parents(".multiselect-element-wrapper").length){i.groupElement&&i.groupElement.data("option-group",t);var o=e("<div></div>").addClass("multiselect-element-wrapper").data("option-group",t),n=e("<div></div>").addClass("multiselect-element-wrapper").data("option-group",t);o.append(i.selected.listElement.hide()),(t!=s||t==s&&a)&&n.append(i.available.listElement.show()),o.append(i.selected.listContainer),n.append(i.available.listContainer),l.selected.append(o),l.available.append(n)}i.count=0},this._listContainers,this._widget.options.showDefaultGroupHeader);for(var l,a,o=0,n=this._elements.length;n>o;o++)l=this._elements[o],a=this._groups.get(l.optionGroup),-1==a.startIndex||a.startIndex>=o?(a.startIndex=o,a.count=1):a.count++,l.listElement.data("element-index",l.index=o),(void 0==l.optionElement.data("element-index")||l.selected!=l.optionElement.prop("selected"))&&(l.selected=l.optionElement.prop("selected"),l.optionElement.data("element-index",o),this._appendToList(l));this._updateGroupElements(),this._widget._updateHeaders(),this._groups.each(function(e,t,i){i._reorderSelected(e)},this),this._bufferedMode(!1)},filter:function(e,t){if(e&&!t){var i={text:e};if(!this._widget._triggerUIEvent(o,i))return;e=i.text}this._bufferedMode(!0);var s=this._widget.options.filterSelected;e=(""+e).toLowerCase(),0==e.length&&(e=!1);for(var l,a,n=0,r=this._elements.length;r>n;n++)l=this._elements[n],a=!(!e||l.optionElement.text().toLowerCase().indexOf(e)>-1),l.selected&&!s||l.filtered==a?l.selected&&(l.filtered=!1):(l.listElement[a?"hide":"show"](),l.filtered=a);this._widget._updateHeaders(),this._bufferedMode(!1)},getSelectionInfo:function(){for(var e={selected:{total:0,count:0,filtered:0},available:{total:0,count:0,filtered:0}},t=0,i=this._elements.length;i>t;t++){var s=this._elements[t];e[s.selected?"selected":"available"][s.filtered?"filtered":"count"]++,e[s.selected?"selected":"available"].total++}return e},setSelected:function(e,t,i){e.optionElement.attr("disabled")&&t||(e.optionElement.prop("selected",e.selected=t),this._appendToList(e),i||(this._widget.options.sortable&&t&&this._reorderSelected(e.optionGroup),this._updateGroupElements(this._groups.get(e.optionGroup)),this._widget._updateHeaders(),this._widget._triggerUIEvent(a,{optionElements:[e.optionElement[0]],selected:t})))},setSelectedAll:function(t){var i=[],s={};this._bufferedMode(!0);for(var l,o=0,n=this._elements.length;n>o;o++)l=this._elements[o],l.selected==t||l.optionElement.attr("disabled")||t&&(l.filtered||l.selected)||(this.setSelected(l,t,!0),i.push(l.optionElement[0]),s[l.optionGroup]=!0);if(this._widget.options.sortable&&t){var r=this;e.each(s,function(e){r._reorderSelected(e)})}this._updateGroupElements(),this._widget._updateHeaders(),this._bufferedMode(!1),this._widget._triggerUIEvent(a,{optionElements:i,selected:t})}},e.uix.multiselect.i18n={"":{itemsSelected_nil:"No options selected",itemsSelected:"{count} option selected",itemsSelected_plural:"{count} options selected",itemsAvailable_nil:"No items available",itemsAvailable:"{count} option available",itemsAvailable_plural:"{count} options available",itemsFiltered_nil:"No options filtered",itemsFiltered:"{count} option filtered",itemsFiltered_plural:"{count} options filtered",selectAll:"Select All",deselectAll:"Deselect All",search:"Search",collapseGroup:"Collapse Group",expandGroup:"Expand Group",selectAllGroup:"Select All Group",deselectAllGroup:"Deselect All Group"}}}(jQuery);